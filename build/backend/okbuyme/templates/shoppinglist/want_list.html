{% extends "base.html" %}
{% load i18n %}

{% block title %}
    {{ block.super }} | {% trans "Your list" %}
{% endblock title %}

{% block templates %}
<script type="text/template" id="WantTemplate">
    <div class="want">
        <strong class="name"><%= name %></strong>
        <a href="#" class="delete">X</a>
        <% if (notes) { %>
            <div class="details">
                <%= notes %>
            </div>
        <% } %>
    </div>
</script>

<script type="text/template" id="AddWantFormTemplate">
</script>
{% endblock templates %}

{% block main_content %}
{% comment %}
<div id="AddButton" class="clearfix">
    <a id="AddWant" class="ir" href="#">{% trans "Add" %}</a>
</div>
{% endcomment %}

<div id="ListArea">
    {% comment %}
    <form action="." method="POST" id="AddWantForm">
        {% csrf_token %}
        {% include "includes/form-snippet.html" %}
        <div class="form-row submit">
            <input type="submit" value="{% trans "Save this item" %}" />
        </div>
    </form>
    {% endcomment %}
    <p>{% trans "Lorem ipsum dolor sit yadda yadda." %}</p>
    <ul id="WantList" class="clearfix"></ul>
</div>
{% endblock main_content %}


{% block javascript %}
<script language="JavaScript">
$(function(){
  // The document is ready, so kickoff the app. There is already an initialized
  // (and empty) okbuyme.app.wants Collection, so call its fetch() method to AJAX
  // get the initial list of Wants. Fetch will take the returned JSON from the
  // server, parse it, and add each Want to the collection. Note that fetch() also
  // calls  If that's successful, we can render the list.
  okbuyme.app.wants.fetch({
    add: true,
    success: function(collection, resp){
      _.log('SUCCESS: Got list of wants; ok to render list');
      new AppView();
    },
    error: function(){
      alert("An error occurred getting your list of items.");
    }
  });
});
</script>
{% endblock %}
